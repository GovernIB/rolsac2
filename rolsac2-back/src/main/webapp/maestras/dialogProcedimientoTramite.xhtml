<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:my="http://java.sun.com/jsf/composite/components"
>

<ui:composition template="/WEB-INF/templates/layoutDialog.xhtml">

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam id="MODO_ACCESO" name="MODO_ACCESO" value="#{dialogProcedimientoTramite.modoAcceso}"/>
            <f:viewParam id="ID" name="ID" value="#{dialogProcedimientoTramite.id}"/>
            <f:viewParam id="OCULTAR_INICIACION" name="OCULTAR_INICIACION"
                         value="#{dialogProcedimientoTramite.ocultarIniciacion}"/>
            <f:viewAction action="#{dialogProcedimientoTramite.load}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="pageTitleDialog">
        <h:outputFormat value="#{labels['dialogProcedimientoTramite.detalle']}"
                        rendered="#{!dialogProcedimientoTramite.isModoAlta()}"/>
        <h:outputFormat value="#{labels['dialogProcedimientoTramite.nuevo']}"
                        rendered="#{dialogProcedimientoTramite.isModoAlta()}"/>
    </ui:define>
    <ui:define name="contentDialog">
        <p:panel header="Prueba">
            <p>Prueba a ver si funciona correctamente el update</p>
        </p:panel>
    </ui:define>
    <ui:define name="contentIdioma">

        <span class="pi pi-tag" style="margin-top:10px"/>
        <p:outputLabel value="#{labels['dict.idioma']}:" style="margin-right:4px;margin-top:2px;"/>
        <p:selectOneButton id="opcionIdioma" value="#{dialogProcedimientoTramite.idioma}" styleClass="botoneraRed"
                           unselectable="false">
            <f:selectItems value="#{sessionBean.getIdiomasPermitidosList()}" var="idioma"
                           itemValue="#{idioma}" itemLabel="#{labels['idiomas.' += idioma]}"/>
            <p:ajax update="formDialog:txtNombre formDialog:txtRequisitos formDialog:txtDocum formDialog:txtTermMax formDialog:txtOrgInstr formDialog:txtTraUrl formDialog:txtObservaciones"
                    process="@this"/>
        </p:selectOneButton>
        <p:commandButton action="#{dialogProcedimientoTramite.traducir}"
                         icon="pi pi-compass" iconPos="top"
                         value="#{labels['dict.traducir']}"
                         style="margin-left:10px"
                         update="messagesDialog"
                         process="@this"
                         rendered="#{!dialogProcedimientoTramite.isModoConsulta() and dialogProcedimientoTramite.tradExiste()}">
            <p:ajax event="dialogReturn" listener="#{dialogProcedimientoTramite.returnDialogTraducir}" process="@this"
                    update="formDialog:txtNombre formDialog:txtRequisitos  formDialog:txtDocum formDialog:txtTermMax formDialog:txtObservaciones"/>
        </p:commandButton>

    </ui:define>

    <ui:define name="contentDialog">
        <h:outputStylesheet library="css">
            .ui-chkbox ~ label {
                font-size: 1.2em;
            }
        </h:outputStylesheet>
        <p:growl id="messagesDialog"
                 globalOnly="false"
                 showDetail="false"
                 life="5000"
                 escape="false"/>
        <div class="row" style="margin-right: 0px;"><div class="ui-g-12 ui-md-9 pl-4 panel-container">
            <p:panel id="panelNombre" header="#{labels['dialogProcedimientoTramite.edicion']}"
                     rendered="#{!empty dialogProcedimientoTramite.nombreProcedimiento.getTraduccionConValor(sessionBean.lang, 'ca')}">
                <div class="form-row">
                    <div class="form-group">
                        <h6 id="txtTituloNombre" style="font-size:1.2em"
                            class="font-weight-bold mt-3">#{dialogProcedimientoTramite.nombreProcedimiento.getTraduccionConValor(sessionBean.lang, 'ca')}</h6>
                    </div>
                </div>
            </p:panel>
            <p:panel id="panelDatosPublicacion" header="#{labels['dialogProcedimientoTramite.datosDePublicacion']}">
                <div class="form-row">
                    <div class="form-group col-md-2" style="margin-top:-5px">
                        <p:outputLabel styleClass="mb-1" value="#{labels['dict.codigo']}:" for="txtCodigo"/>
                        <p:inputText id="txtCodigo" value="#{dialogProcedimientoTramite.data.codigo}"
                                     styleClass="w95" disabled="true"/>
                    </div>
                    <div class="form-group col-md-4">
                        <p:outputLabel value="#{labels['dialogProcedimientoTramite.fechaPublicacion']}:"
                                       for="txtFechaPublicacion"
                                       styleClass="mb-1 pt-0"/>
                        <p>
                            <p:datePicker showIcon="true"  id="txtFechaPublicacion" styleClass="fecha"
                                        locale="#{sessionBean.lang}" disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                        value="#{dialogProcedimientoTramite.data.fechaPublicacion}"
                                        pattern="dd/MM/yyyy HH:mm"
                                        required="#{empty param['formDialog:closeButton']}"
                                        requiredMessage="#{labels['dict.obligatorio.fechaPublicacion']}"
                                        showOn="button"/>
                        </p>
                    </div>
                    <div class="form-group col-md-4">
                        <p:outputLabel value="#{labels['viewTipoTramitacion.fasePro.titulo']}:" for="faseProc"
                                       styleClass="mb-1 pt-0"/>
                        <p:selectOneMenu id="faseProc"
                                             required="#{empty param['formDialog:closeButton']}"
                                             requiredMessage="#{labels['dict.obligatorio.fase']}"
                                             value="#{dialogProcedimientoTramite.data.fase}"
                                             styleClass="w90" disabled="#{dialogProcedimientoTramite.isModoConsulta()}">
                                <f:selectItem itemLabel="#{labels['viewTipoTramitacion.platTramitacion.seleccione']}"
                                              itemValue="#{null}" id="seleccione2"/>
                                <c:if test="#{dialogProcedimientoTramite.mostrarIniciacion}">
                                    <f:selectItem itemLabel="#{labels['viewTipoTramitacion.fasePro.iniciacion']}"
                                                  itemValue="1"
                                                  disabled="#{!dialogProcedimientoTramite.mostrarIniciacion}"/>
                                </c:if>
                            <c:if test="#{!dialogProcedimientoTramite.mostrarSoloIniciacion}">
                                <f:selectItem itemLabel="#{labels['viewTipoTramitacion.fasePro.instruccion']}"
                                              itemValue="2"/>
                                <f:selectItem itemLabel="#{labels['viewTipoTramitacion.fasePro.finalizacion']}"
                                              itemValue="3"/>
                            </c:if>

                                <p:ajax update="txtTraPlantilla" listener="#{dialogProcedimientoTramite.cambiaFase}"
                                        event="change"/>
                            </p:selectOneMenu>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-2">
                    </div>
                    <div class="form-group col-md-4">
                        <p:outputLabel value="#{labels['dialogProcedimientoTramite.fechaInicio']}:" for="txtFechaInicio"
                                       styleClass="mb-1 pt-0"/>
                        <p>
                            <p:datePicker showIcon="true"  id="txtFechaInicio" styleClass="fecha"
                                          locale="#{sessionBean.lang}" disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                        value="#{dialogProcedimientoTramite.data.fechaInicio}"
                                        required="#{empty param['formDialog:closeButton']}"
                                        requiredMessage="#{labels['dict.obligatorio.fechaInicio']}"
                                        pattern="dd/MM/yyyy HH:mm" showOn="button"/>
                        </p>
                    </div>
                    <div class="form-group col-md-4">
                        <p:outputLabel value="#{labels['dialogProcedimientoTramite.fechaCierre']}:" for="txtFechaCierre"
                                       styleClass="mb-1 pt-0"/>
                        <p>
                            <p:datePicker showIcon="true"  id="txtFechaCierre" styleClass="fecha"
                                          locale="#{sessionBean.lang}" disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                        value="#{dialogProcedimientoTramite.data.fechaCierre}"
                                        pattern="dd/MM/yyyy HH:mm" showOn="button"/>
                        </p>
                    </div>
                </div>
            </p:panel>
            <p:panel id="panelDatos" header="#{labels['dialogProcedimientoTramite.datos']}">

                <div class="form-row">
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.nombreTramite']}:"
                                       for="txtNombre"/>
                        <my:literalAreaComponent id="txtNombre" styleClass="w95"
                                             value="#{dialogProcedimientoTramite.data.nombre}"
                                             soloLecture="#{dialogProcedimientoTramite.isModoConsulta()}"
                                             required="#{empty param['formDialog:closeButton']}"
                                             idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                             idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                             idioma="#{dialogProcedimientoTramite.idioma}"
                                             literal="#{dialogProcedimientoTramite.data.nombre}"
                                             maxlength="255"
                                             nombreLiteral="#{labels['dialogProcedimientoTramite.nombreTramite']}">
                            <f:validator validatorId="es.caib.rolsac2.back.validators.ValidadorLiteral"/>
                        </my:literalAreaComponent>
                    </div>
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.requisitos']}:"
                                       for="txtRequisitos"/>
                            <my:literalAreaComponent id="txtRequisitos" styleClass="w95"
                                                 value="#{dialogProcedimientoTramite.data.requisitos}"
                                                 soloLecture="#{dialogProcedimientoTramite.isModoConsulta()}"
                                                 required="#{empty param['formDialog:closeButton']}"
                                                 idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                                 idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                                 idioma="#{dialogProcedimientoTramite.idioma}"
                                                 literal="#{dialogProcedimientoTramite.data.requisitos}"
                                                 nombreLiteral="#{labels['dialogProcedimientoTramite.requisitos']}">
                                <f:validator validatorId="es.caib.rolsac2.back.validators.ValidadorLiteral"/>
                            </my:literalAreaComponent>
                    </div>
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.documentacion']}:"
                                       for="txtDocum"/>
                            <my:literalAreaComponent id="txtDocum" styleClass="w95"
                                                 value="#{dialogProcedimientoTramite.data.documentacion}"
                                                 soloLecture="#{dialogProcedimientoTramite.isModoConsulta()}"
                                                 required="#{empty param['formDialog:closeButton']}"
                                                 idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                                 idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                                 idioma="#{dialogProcedimientoTramite.idioma}"
                                                 literal="#{dialogProcedimientoTramite.data.documentacion}"
                                                 nombreLiteral="#{labels['dialogProcedimientoTramite.documentacion']}">
                                <f:validator validatorId="es.caib.rolsac2.back.validators.ValidadorLiteral"/>
                            </my:literalAreaComponent>
                    </div>
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.terminoMaximo']}:"
                                       for="txtTermMax"/>
                            <my:literalAreaComponent id="txtTermMax" styleClass="w95"
                                                 value="#{dialogProcedimientoTramite.data.terminoMaximo}"
                                                 soloLecture="#{dialogProcedimientoTramite.isModoConsulta()}"
                                                 required="#{empty param['formDialog:closeButton']}"
                                                 idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                                 idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                                 idioma="#{dialogProcedimientoTramite.idioma}"
                                                 literal="#{dialogProcedimientoTramite.data.terminoMaximo}"
                                                 maxlength="512"
                                                 nombreLiteral="#{labels['dialogProcedimientoTramite.terminoMaximo']}">
                                <f:validator validatorId="es.caib.rolsac2.back.validators.ValidadorLiteral"/>
                            </my:literalAreaComponent>


                    </div>
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.observaciones']}:"
                                       for="txtObservaciones"/>
                            <my:literalAreaComponent id="txtObservaciones" styleClass="w95"
                                                 value="#{dialogProcedimientoTramite.data.observacion}"
                                                 soloLecture="#{dialogProcedimientoTramite.isModoConsulta()}"
                                                 idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                                 idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                                 idioma="#{dialogProcedimientoTramite.idioma}"
                                                 literal="#{dialogProcedimientoTramite.data.observacion}"
                                                 nombreLiteral="#{labels['dialogProcedimientoTramite.observaciones']}">
                            </my:literalAreaComponent>

                    </div>
                </div>
            </p:panel>
            <p:panel id="panelOrganos" header="#{labels['dialogProcedimientoTramite.organos']}">
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <p:outputLabel styleClass="mr-2 mb-1 pt-0"
                                       value="#{labels['dialogProcedimientoTramite.organoCompetente']}:"
                                       for="txtOrgInstr"/>
                        <p>

                            <p:inputText id="labelComun"
                                         value="#{dialogProcedimientoTramite.comunUA.getTraduccionConValor(dialogProcedimientoTramite.idioma)}"
                                         rendered="#{dialogProcedimientoTramite.isProcedimientoComun()}"
                                         styleClass="w95"
                                         disabled="true"/>

                            <p:inputText id="txtOrgInstr"
                                         value="#{dialogProcedimientoTramite.data.unidadAdministrativa.nombre.getTraduccionConValor(dialogProcedimientoTramite.idioma)}"
                                         rendered="#{!dialogProcedimientoTramite.isProcedimientoComun()}"
                                         styleClass="w85 mr-1"
                                         disabled="true"/>
                            <p:commandButton
                                    action="#{dialogProcedimientoTramite.abrirVentanaUA()}"
                                    icon="pi pi-sitemap"
                                    value=" "
                                    styleClass="w35px h30px iconoUAselector"
                                    process="@this"
                                    style="position:relative; top:10px;"
                                    rendered="#{!dialogProcedimientoTramite.isProcedimientoComun()}"
                                    disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                    id="btnAbrirUAInstr"
                            >
                                <p:ajax event="dialogReturn"
                                        listener="#{dialogProcedimientoTramite.returnDialogoUA}"
                                        process="@this"
                                        update="lblUAiconoResp lblUAiconoResp2" />
                            </p:commandButton>
                            <h:outputLink id="lblUAiconoResp" value="#" styleClass="w20px labelWarningUAPadre">
                                <h:outputText id="lblUAiconoResp2" value=" "  styleClass="ml-3 pt-1 labelWarningUA pi #{dialogProcedimientoTramite.getCssUA()}" />
                            </h:outputLink>
                            <p:tooltip id="toolTipFadeResp" for="lblUAiconoResp" value="#{labels['dialogProcedimiento.msgInstructorError']}" position="top"/>
                        </p>
                    </div>
                </div>
            </p:panel>
            <p:panel id="panelCanales" header="#{labels['dialogProcedimientoTramite.canales']}">
                <div class="form-row align-items-center">
                    <div class="form-group col-md-5">
                        <!--Aquí es mapear luego con los bools que tiene TipoTramitacionDTO para ello-->
                        <p:selectManyCheckbox id="canalesTramitacion"
                                              value="#{dialogProcedimientoTramite.canalesSeleccionados}">
                            <f:selectItem id="canalesTramitacionTel"
                                          itemLabel="#{labels['dialogProcedimientoTramite.canalTelematico']}"
                                          itemValue="TEL"/>
                            <f:selectItem itemLabel="#{labels['dialogProcedimientoTramite.canalPresencial']}"
                                          itemValue="PRE"/>
                            <!--<f:selectItem itemLabel="Telefónico" itemValue="TFN"  />-->
                            <p:ajax update="txtTraPlantilla txtTraId txtTraVer txtTraPlat txtTraUrl txtTraParam txtTraUrl txtTraUrl:texto txtOpcionTelematica"
                                    event="change" listener="#{dialogProcedimientoTramite.cambiaTipo}"/>
                        </p:selectManyCheckbox>
                    </div>
                    <div class="form-group col-md-5">
                        <p:selectOneMenu id="txtOpcionTelematica"
                                         value="#{dialogProcedimientoTramite.opcionTelematica}"
                                         requiredMessage="#{labels['dict.obligatorio.opcionTelematica']}"
                                         required="#{empty param['formDialog:closeButton'] and dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                         disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                                        !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                         autoWidth="false" style="min-width: 14em;"
                        >
                            <f:selectItem
                                    itemLabel="#{labels['dialogProcedimientoTramite.opcionTelematica.seleccione']}"
                                    itemValue="#{null}"/>
                            <f:selectItem
                                    itemLabel="#{labels['dialogProcedimientoTramite.opcionTelematica.seleccionePlantilla']}"
                                    itemValue="1"/>
                            <f:selectItem
                                    itemLabel="#{labels['dialogProcedimientoTramite.opcionTelematica.seleccionePlataforma']}"
                                    itemValue="2"/>
                            <f:selectItem
                                    itemLabel="#{labels['dialogProcedimientoTramite.opcionTelematica.seleccioneUrl']}"
                                    itemValue="3"/>
                            <p:ajax update="txtOpcion txtTraPlantilla panelFormCanales" event="change" resetValues="true"/>

                        </p:selectOneMenu>
                        <p:inputText id="txtOpcion" style="display:none"
                                     value="#{dialogProcedimientoTramite.opcionTelematica}" />
                    </div>
                </div>
                <h:panelGroup id="panelFormCanales">
                    <h:panelGroup id="panelPlantilla"
                                  rendered="#{dialogProcedimientoTramite.isOpcionTelematicaPlantilla()}">
                        <div id="divPlantilla" class="form-row" style="height:100px !important;">
                            <div class="form-group col-md-5">
                                <p:outputLabel id="lbltxtTraPlantilla" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dialogProcedimientoTramite.seleccionPlantilla']}:"
                                               for="txtTraPlantilla"/>

                                <p:selectOneMenu id="txtTraPlantilla"
                                                 value="#{dialogProcedimientoTramite.data.plantillaSel}"
                                                 styleClass="w100px" style="width: 300px !important;"
                                                 requiredMessage="La plantilla es obligatoria"
                                                 required="#{dialogProcedimientoTramite.isOpcionTelematicaPlantilla()}"
                                                 disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                                        !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                                 converter="#{tipoTramitacionConverter}"
                                >
                                    <f:selectItem itemLabel="#{labels['viewTipoTramitacion.platTramitacion.seleccione']}"
                                                  itemValue="#{null}" id="seleccione3"/>
                                    <f:selectItems value="#{dialogProcedimientoTramite.plantillasTipoTramitacion}"
                                                   var="plantilla"
                                                   itemLabel="#{plantilla.descripcion.getTraduccionConValor(dialogProcedimientoTramite.idioma)}"
                                                   itemValue="#{plantilla}"/>
                                    <p:ajax update="txtTraId txtTraVer txtTraPlat txtTraUrl txtTraParam" event="change"/>

                                </p:selectOneMenu>
                            </div>
                        </div>
                    </h:panelGroup>

                    <h:panelGroup id="panelDatosTelematico"
                                  rendered="#{dialogProcedimientoTramite.isOpcionTelematicaDatos()}">
                        <div id="divDatosTelematico1" class="form-row">
                            <div class="form-grup col-md-4">
                                <p:outputLabel id="lbltxtTraId" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dict.identificador']}:"
                                               for="txtTraId"/>
                                <p:inputText id="txtTraId"
                                             disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                                    !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                             value="#{dialogProcedimientoTramite.data.tipoTramitacion.tramiteId}"
                                             styleClass="w95"
                                             onblur="this.value = this.value.toUpperCase();"
                                             requiredMessage="#{labels['dict.obligatorio.identificador']}"
                                             required="#{empty param['formDialog:closeButton'] and dialogProcedimientoTramite.isOpcionTelematicaDatos()}"
                                             maxlength="50">
                                    <p:keyFilter regEx="/[0-9_-a-zA-Z\.]/i" preventPaste="false"/>
                                    <f:validateRegex pattern="^[0-9_-a-zA-Z\.]{1,50}$"/>
                                </p:inputText>
                            </div>
                            <div class="form-grup col-md-2">
                                <p:outputLabel id="lbltxtTraVer" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dialogProcedimientoTramite.version']}:"
                                               for="txtTraVer"/>
                                <p:inputText id="txtTraVer" decimalPlaces="0"
                                             disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                                    !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                             value="#{dialogProcedimientoTramite.data.tipoTramitacion.tramiteVersion}"
                                             required="#{empty param['formDialog:closeButton'] and dialogProcedimientoTramite.isOpcionTelematicaDatos()}"
                                             requiredMessage="#{labels['dict.obligatorio.version']}"
                                             onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;"
                                             width="100px"
                                             maxlength="3"
                                             style="width: 100px !important;" />
                            </div>
                            <div class="form-group col-md-6">
                                <p:outputLabel id="lbltxtTraPlat" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dialogProcedimientoTramite.plataforma']}:"
                                               for="txtTraPlat"/>
                                <p:selectOneMenu id="txtTraPlat"
                                                 value="#{dialogProcedimientoTramite.data.tipoTramitacion.codPlatTramitacion}"
                                                 styleClass="w95"
                                                 autoWidth="false"
                                                 required="#{empty param['formDialog:closeButton'] and dialogProcedimientoTramite.isOpcionTelematicaDatos()}"
                                                 requiredMessage="#{labels['dict.obligatorio.plataformaTramitación']}"
                                                 disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                                     !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                                 converter="#{platTramitElectronicaConverter}">
                                    <f:selectItem itemLabel="#{labels['dialogUnidadAdministrativa.selecciona.tipo']}"
                                                  itemValue="#{null}"/>
                                    <f:selectItems value="#{dialogProcedimientoTramite.platTramitElectronica}"
                                                   var="plataforma"
                                                   itemLabel="#{plataforma.descripcion.getTraduccionConValor(sessionBean.lang)}"
                                                   itemValue="#{plataforma}"/>
                                </p:selectOneMenu>
                            </div>
                        </div>
                        <div id="divDatosTelematico2" class="form-row">
                            <div class="form-grup col-md-6">
                                <p:outputLabel id="lbltxtTraParam" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dialogProcedimientoTramite.parametros']}:"
                                               for="txtTraParam"/>
                                <p:inputText id="txtTraParam"
                                             disabled="#{dialogProcedimientoTramite.isModoConsulta() ||
                                             !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                             value="#{dialogProcedimientoTramite.data.tipoTramitacion.tramiteParametros}"
                                             maxlength="255"
                                             styleClass="w95"/>
                            </div>
                        </div>
                    </h:panelGroup>

                    <h:panelGroup id="panelUrlTelematico" rendered="#{dialogProcedimientoTramite.isOpcionTelematicaUrl()}">
                        <div id="divUrlTelematico" class="form-row" style="height:100px !important;">
                            <div class="form-group col-md-6">
                                <p:outputLabel id="lbltxtTraUrl" styleClass="mr-2 mb-1 pt-0"
                                               value="#{labels['dialogProcedimientoTramite.url']}:"
                                               for="txtTraUrl"/>
                                <my:literalComponent id="txtTraUrl" styleClass="w95"
                                                     value="#{dialogProcedimientoTramite.data.tipoTramitacion.url}"
                                                     required="#{dialogProcedimientoTramite.isOpcionTelematicaUrl()}"
                                                     soloLecture="#{dialogProcedimientoTramite.isModoConsulta() || !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                                     disabled="#{dialogProcedimientoTramite.isModoConsulta() || !dialogProcedimientoTramite.canalesSeleccionados.contains('TEL')}"
                                                     idiomasObligatorios="#{sessionBean.getIdiomasObligatorios()}"
                                                     idiomasPermitidos="#{sessionBean.getIdiomasPermitidos()}"
                                                     idioma="#{dialogProcedimientoTramite.idioma}"
                                                     literal="#{dialogProcedimientoTramite.data.tipoTramitacion.url}"
                                                     maxlength="512"
                                                     nombreLiteral="#{labels['dialogProcedimientoTramite.url']}">
                                    <f:validator validatorId="es.caib.rolsac2.back.validators.ValidadorLiteral" disabled="#{dialogProcedimientoTramite.isModoConsulta() or
                                                             !dialogProcedimientoTramite.isOpcionTelematicaUrl()}"/>
                                </my:literalComponent>

                            </div>
                        </div>
                    </h:panelGroup>

                </h:panelGroup>

            </p:panel>
        </div>
        <div class="ui-g-12 ui-md-3 pr-1 ">
            <div class="row left-container mx-0 mb-2">
                <div class="col-12 left-container-header text-center">
                    <p class="left-container-tit mt-2 mb-1" style="font-size: 1.1em">#{labels['dialogProcedimientoTramite.modelos']}</p>
                </div>
                <div class="col-10 p-1">
                    <p:dataTable id="dataDocumentosModelo" var="td"
                                 value="#{dialogProcedimientoTramite.data.listaModelos}"
                                 emptyMessage="#{labels['dialogProcedimiento.noDocumentos']}" scrollable="true"
                                 scrollHeight="120"
                                 paginator="false" selectionMode="single"
                                 selection="#{dialogProcedimientoTramite.modeloSeleccionado}"
                                 rowKey="#{td.codigoString}" styleClass="noHeader">

                        <!-- Necesario para actualizar en controlador la fila seleccionada -->
                        <p:ajax event="rowSelect" global="false"/>
                        <p:ajax event="rowUnselect"/>
                        <p:ajax event="rowDblselect"
                                oncomplete="triggerDblClickModelo();"
                        />

                        <p:column headerText="#{labels['dialogProcedimiento.descripcion']}"
                                  styleClass="text-center w75">
                            <h:outputText value="#{td.titulo.getTraduccionConValor(dialogProcedimientoTramite.idioma)}" class="labelGrande" />
                        </p:column>

                    </p:dataTable>
                </div>
                <div class="col-2 p-1 d-flex flex-column align-content-center justify-content-center align-items-center">
                    <p:commandButton title="#{labels['dict.nuevo']}" icon="pi pi-plus" styleClass="text-success"
                                     disabled="#{dialogProcedimientoTramite.isModoConsulta()}" process="@this"
                                     actionListener="#{dialogProcedimientoTramite.nuevoModelo()}">
                        <p:ajax event="dialogReturn" listener="#{dialogProcedimientoTramite.returnDialogModelo}"
                                process="@this"
                                update="dataDocumentosModelo"/>
                    </p:commandButton>
                    <p:commandButton title="#{labels['dict.eliminar']}" icon="pi pi-minus" styleClass="text-danger"
                                     disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                     action="#{dialogProcedimientoTramite.borrarModelo}"
                                     process="@this" update="dataDocumentosModelo messagesDialog"/>
                    <p:commandButton title="#{labels['dict.editar']}" icon="pi pi-pencil"
                                     id="btnEditarModelo"
                                     action="#{dialogProcedimientoTramite.editarModelo}"
                                     process="@this" update="dataDocumentosModelo messagesDialog">
                        <p:ajax event="dialogReturn" listener="#{dialogProcedimientoTramite.returnDialogModelo}"
                                process="@this"
                                update="dataDocumentosModelo"/>
                    </p:commandButton>
                    <p:commandButton id="btnSubirModelo" title="#{labels['dict.subir']}" icon="pi pi-arrow-circle-up"
                                     action="#{dialogProcedimientoTramite.subirModelo}"
                                     process="@this" update="dataDocumentosModelo messagesDialog"/>
                    <p:commandButton id="btnBajarModelo" title="#{labels['dict.bajar']}" icon="pi pi-arrow-circle-down"
                                     action="#{dialogProcedimientoTramite.bajarModelo}"
                                     process="@this" update="dataDocumentosModelo messagesDialog"/>
                </div>
            </div>
            <div class="row left-container mx-0 mb-2">
                <div class="col-12 left-container-header text-center">
                    <p class="left-container-tit mt-2 mb-1" style="font-size: 1.1em">#{labels['dialogProcedimientoTramite.documentosRelacionados']}</p>
                </div>
                <div class="col-10 p-1">
                    <p:dataTable id="dataDocumentosRelacionados" var="td"
                                 value="#{dialogProcedimientoTramite.data.listaDocumentos}"
                                 emptyMessage="#{labels['dialogProcedimiento.noDocumentos']}" scrollable="true"
                                 scrollHeight="120"
                                 paginator="false" selectionMode="single"
                                 selection="#{dialogProcedimientoTramite.documentoSeleccionado}"
                                 rowKey="#{td.codigoString}" styleClass="noHeader">

                        <!-- Necesario para actualizar en controlador la fila seleccionada -->
                        <p:ajax event="rowSelect" global="false"/>
                        <p:ajax event="rowSelect" global="false"/>
                        <p:ajax event="rowUnselect"/>
                        <p:ajax event="rowDblselect" oncomplete="triggerDblClickDocumento();"/>
                         <p:column headerText="#{labels['dialogProcedimiento.descripcion']}"
                                  styleClass="text-center w75">
                            <h:outputText value="#{td.titulo.getTraduccionConValor(dialogProcedimientoTramite.idioma)}" class="labelGrande" />
                        </p:column>
                    </p:dataTable>
                </div>
                <div class="col-2 p-1 d-flex flex-column align-content-center justify-content-center align-items-center">
                    <p:commandButton title="#{labels['dict.nuevo']}" icon="pi pi-plus" styleClass="text-success"
                                     disabled="#{dialogProcedimientoTramite.isModoConsulta()}" process="@this"
                                     actionListener="#{dialogProcedimientoTramite.nuevoDocumento()}">
                        <p:ajax event="dialogReturn" listener="#{dialogProcedimientoTramite.returnDialogDocumento}"
                                process="@this"
                                update="dataDocumentosRelacionados"/>
                    </p:commandButton>
                    <p:commandButton disabled="#{dialogProcedimientoTramite.isModoConsulta()}"
                                     title="#{labels['dict.eliminar']}" icon="pi pi-minus" styleClass="text-danger"
                                     action="#{dialogProcedimientoTramite.borrarDocumento}"
                                     process="@this" update="dataDocumentosRelacionados messagesDialog"/>
                    <p:commandButton title="#{labels['dict.editar']}" icon="pi pi-pencil"
                                     id="btnEditarDocumento"
                                     action="#{dialogProcedimientoTramite.editarDocumento}"
                                     process="@this" update="messagesDialog"
                                        >
                    <p:ajax event="dialogReturn" listener="#{dialogProcedimientoTramite.returnDialogDocumento}"
                            process="@this"
                            update="dataDocumentosRelacionados"/>
                    </p:commandButton>
                    <p:commandButton id="btnSubirDocumento" title="#{labels['dict.subir']}" icon="pi pi-arrow-circle-up"
                                     action="#{dialogProcedimientoTramite.subirDocumento}"
                                     process="@this" update="dataDocumentosRelacionados messagesDialog"/>
                    <p:commandButton id="btnBajarDocumento" title="#{labels['dict.bajar']}"
                                     icon="pi pi-arrow-circle-down"
                                     action="#{dialogProcedimientoTramite.bajarDocumento}"
                                     process="@this" update="dataDocumentosRelacionados messagesDialog"/>
                </div>
            </div>
        </div>
        </div>
        <h:outputScript>
            function triggerDblClickModelo() {
                document.getElementById("formDialog:btnEditarModelo").click();
            }

            function triggerDblClickDocumento() {
                document.getElementById("formDialog:btnEditarDocumento").click();
            }

        </h:outputScript>

        <p:confirmDialog showEffect="fade" hideEffect="fade" header="#{labels['dict.cerrar.cambiosSinGuardar.titulo']}"
                         responsive="true" width="458px" message="#{labels['dict.cerrar.cambiosSinGuardar.mensaje']}"
                         widgetVar="cdSalirSinGuardar">
            <p:commandButton value="#{labels['dict.si']}" action="#{dialogProcedimientoTramite.cerrarSinCheck()}"
                             process="@this" update="messagesDialog" oncomplete="PF('cdSalirSinGuardar').hide();"/>
            <p:commandButton value="#{labels['dict.no']}" onclick="PF('cdSalirSinGuardar').hide();"/>
        </p:confirmDialog>
    </ui:define>

    <ui:define name="contentFooterDialogRight">
        <p:commandButton action="#{dialogProcedimientoTramite.ayuda}"
                         icon="pi pi-info-circle" iconPos="top"
                         value="#{labels['dict.ayuda']}"
                         process="@this"/>
        <p:commandButton action="#{dialogProcedimientoTramite.guardar}"
                         value="#{labels['dict.aceptar']}" update="messagesDialog panelDatos panelDatosPublicacion panelOrganos panelCanales "
                         rendered="#{!dialogProcedimientoTramite.isModoConsulta()}"
                         process="@all"/>
        <p:commandButton action="#{dialogProcedimientoTramite.cerrar}"
                         value="#{labels['dict.cerrar']}" update="messagesDialog"
                         process="@this"/>

    </ui:define>
</ui:composition>
</html>
